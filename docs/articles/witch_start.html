<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Starting with witch: winter conditions and characterization • witch</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Starting with witch: winter conditions and characterization">
<meta property="og:description" content="witch">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">witch</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/witch_start.html">Starting with witch: winter conditions and characterization</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Starting with witch: winter conditions and characterization</h1>
                        <h4 class="author">Bernardo Brandão Niebuhr</h4>
            
            <h4 class="date">2020-11-09</h4>
      
      
      <div class="hidden name"><code>witch_start.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Climate and weather conditions are changing continuously and pose several challanges for humans and the biodiversity. However, understand which changes happen every year from long time series of meteorological measurements is not easy. The main purpose of the <code>witch</code> package is to calculate some weather indices based on common weather data (temperature, precipitation, snow depth). The package was designed with the Swedish reindeer husbandry in mind, a system where semi-domesticated reindeer live with Sami herders, in which winter conditions can influence both reindeer and people. However, it can also be useful for understanding winter conditions in other contexts.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the package using <code><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">devtools::install_github()</a></code> function, then load the package using the function <code>library()</code>. We also load the <code>tidyverse</code> set of packages that is useful for data manipulation and plotting in this vignette.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># devtools::install_github("https://github.com/bniebuhr/winteranalyzer.git")</span>

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">winteranalyzer</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyverse</span>)</pre></body></html></div>
</div>
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h2>
<p>To understand what data is used in the analysis, we’ll take a look at the dataset <code>weather_mittadalen</code>. This corresponds to weather data collected in meteorological stations in to Mittådalen Sami reindeer herding district, in Sweden. It contains time series of daily snow_depth, precipitation, and minimum, maximum, and average temperature, from winters in the period 2008-2020. To know more information about the dataset, see <code><a href="../reference/weather_mittadalen.html">?weather_mittadalen</a></code>. There is also another dataset from a neighboring Sami district, Tåssåsen, called <code>weather_tassasen</code>.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">weather_mittadalen</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">weather_mittadalen</span>)
<span class="co">#&gt; # A tibble: 6 x 7</span>
<span class="co">#&gt;   date                 year snow_depth  prec temp_min temp_max temp_avg</span>
<span class="co">#&gt;   &lt;dttm&gt;              &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 2007-10-01 00:00:00  2008         NA   0.4      6.2      9.9       NA</span>
<span class="co">#&gt; 2 2007-10-02 00:00:00  2008         NA   0        4.2     10.1       NA</span>
<span class="co">#&gt; 3 2007-10-03 00:00:00  2008         NA   0        0.2     13.1       NA</span>
<span class="co">#&gt; 4 2007-10-04 00:00:00  2008         NA   0       -2.6     11         NA</span>
<span class="co">#&gt; 5 2007-10-05 00:00:00  2008         NA   0       -2.9     12.3       NA</span>
<span class="co">#&gt; 6 2007-10-06 00:00:00  2008         NA   0       -4.5     12.8       NA</span></pre></body></html></div>
</div>
<div id="some-indices-that-may-indicate-winter-conditions" class="section level2">
<h2 class="hasAnchor">
<a href="#some-indices-that-may-indicate-winter-conditions" class="anchor"></a>Some indices that may indicate winter conditions</h2>
<p>Explain here the idea behind the ratios between cumulative precipitation and snow depth, as well as the events 3 and 4 from Lundqvist et al (2007).</p>
</div>
<div id="analyzing-weather-conditions" class="section level2">
<h2 class="hasAnchor">
<a href="#analyzing-weather-conditions" class="anchor"></a>Analyzing weather conditions</h2>
<p>The main function of the package is called <code>analyze_weather</code>. It calculates cumulative precipitation, the ratio between cumulative precipitation and snow depth, and identifies events 3 and 4 according to Lundqvist et al (2007), which represent possible formations of ice crust layers, which make it difficult for reindeer to forage and find food.</p>
<p>The function can wither analyze the whole time series of the winter consider only what comes after the first permanent snow. Maybe both things can be important for understanding whether the weather was good or bad in a given winter. The identification of the first permanent snow is done by the function <code><a href="../reference/find_date_permanent_snow.html">find_date_permanent_snow()</a></code>.</p>
<p>The function <code><a href="../reference/analyze_weather.html">analyze_weather()</a></code> also uses the functions <code><a href="../reference/identify_winter_events.html">identify_winter_event3()</a></code> and <code><a href="../reference/identify_winter_events.html">identify_winter_event4()</a></code> to identify these events aforementioned.</p>
<p>Once these analyses are done, beyond looking into values, the function <code><a href="../reference/plot_weather.html">plot_weather()</a></code> may be used to explore relationships between the input and derived variables.</p>
</div>
</div>
<div id="an-example" class="section level1">
<h1 class="hasAnchor">
<a href="#an-example" class="anchor"></a>An example</h1>
<div id="select-a-year-of-data" class="section level2">
<h2 class="hasAnchor">
<a href="#select-a-year-of-data" class="anchor"></a>Select a year of data</h2>
<p>First we select a given year of data, 2014, to understand how the analysis work. According the reindeer herders from this district, this was a hard year because of the harsh weather conditions.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># select one year</span>
<span class="no">weather</span> <span class="kw">&lt;-</span> <span class="no">weather_mittadalen</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">year</span> <span class="kw">==</span> <span class="fl">2014</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">weather</span>)
<span class="co">#&gt; # A tibble: 6 x 7</span>
<span class="co">#&gt;   date                 year snow_depth  prec temp_min temp_max temp_avg</span>
<span class="co">#&gt;   &lt;dttm&gt;              &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 2013-10-01 00:00:00  2014          0   0       -4.5     12.3      2.1</span>
<span class="co">#&gt; 2 2013-10-02 00:00:00  2014          0   0       -4.2     12.5      2.4</span>
<span class="co">#&gt; 3 2013-10-03 00:00:00  2014          0   0       -4.4      9.4      3.5</span>
<span class="co">#&gt; 4 2013-10-04 00:00:00  2014          0   0.2      1.5      7        4.4</span>
<span class="co">#&gt; 5 2013-10-05 00:00:00  2014          0   0.5      3.9     10.4      6  </span>
<span class="co">#&gt; 6 2013-10-06 00:00:00  2014          0   0.7     -3        9.6      4.3</span></pre></body></html></div>
<p>Then we run the function to analyze the weather conditions in this winter.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># analyze weather</span>
<span class="no">weather_condition</span> <span class="kw">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">weather</span>,
       <span class="fu"><a href="../reference/analyze_weather.html">analyze_weather</a></span>(<span class="no">date</span>, <span class="no">snow_depth</span>, <span class="no">prec</span>, <span class="no">temp_min</span>, <span class="no">temp_max</span>, <span class="no">temp_avg</span>,
                       <span class="kw">start</span> <span class="kw">=</span> <span class="st">"first_permanent_snow"</span>))</pre></body></html></div>
<p>When we look at the results, we see a table with time series of input and derived variables calculated, as well as some summaries of the number of events and duration of events 3 and 4.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">weather_condition</span>
<span class="co">#&gt; $weather_indices</span>
<span class="co">#&gt; # A tibble: 212 x 13</span>
<span class="co">#&gt;    date                snow_depth precipitation_s~ temp_min temp_max temp_avg</span>
<span class="co">#&gt;    &lt;dttm&gt;                   &lt;dbl&gt;            &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2013-10-01 00:00:00          0                0     -4.5     12.3      2.1</span>
<span class="co">#&gt;  2 2013-10-02 00:00:00          0                0     -4.2     12.5      2.4</span>
<span class="co">#&gt;  3 2013-10-03 00:00:00          0                0     -4.4      9.4      3.5</span>
<span class="co">#&gt;  4 2013-10-04 00:00:00          0                0      1.5      7        4.4</span>
<span class="co">#&gt;  5 2013-10-05 00:00:00          0                0      3.9     10.4      6  </span>
<span class="co">#&gt;  6 2013-10-06 00:00:00          0                0     -3        9.6      4.3</span>
<span class="co">#&gt;  7 2013-10-07 00:00:00          0                0      2       13.9      8.4</span>
<span class="co">#&gt;  8 2013-10-08 00:00:00          0                0      5.7     14.5     10.7</span>
<span class="co">#&gt;  9 2013-10-09 00:00:00          0                0      3.7     11.8      7.6</span>
<span class="co">#&gt; 10 2013-10-10 00:00:00          0                0     -2.1      6.5      2.1</span>
<span class="co">#&gt; # ... with 202 more rows, and 7 more variables: cumulative_precitation &lt;dbl&gt;,</span>
<span class="co">#&gt; #   prec_snow_ratio &lt;dbl&gt;, prec_snow_diff &lt;dbl&gt;, snow_prec_ratio &lt;dbl&gt;,</span>
<span class="co">#&gt; #   snow_prec_diff &lt;dbl&gt;, events3 &lt;dbl&gt;, events4 &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events3</span>
<span class="co">#&gt; $events3$events3</span>
<span class="co">#&gt;   [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt;  [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt;  [75] 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [112] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [149] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [186] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events3$n_days</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events3$n_events3</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events3$duration_events3</span>
<span class="co">#&gt; [1] 1 1 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events3$event_dates</span>
<span class="co">#&gt; [1] "2013-12-16 UTC" "2013-12-24 UTC" "2014-03-14 UTC"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events3$n_event3_date</span>
<span class="co">#&gt;   [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt;  [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt;  [75] 0 0 1 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [112] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [149] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [186] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events3$events3_begin</span>
<span class="co">#&gt;   [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt;  [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt;  [75] 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [112] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [149] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [186] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events3$n_days_begin</span>
<span class="co">#&gt; [1] 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events3$n_events3_begin</span>
<span class="co">#&gt; [1] 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events3$duration_events3_begin</span>
<span class="co">#&gt; [1] 1 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events3$event_dates_begin</span>
<span class="co">#&gt; [1] "2013-12-16 UTC" "2013-12-24 UTC" "2014-03-15 UTC"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events3$n_event3_date_begin</span>
<span class="co">#&gt;   [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt;  [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt;  [75] 0 0 1 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [112] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [149] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [186] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events4</span>
<span class="co">#&gt; $events4$events4</span>
<span class="co">#&gt;   [1]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt;  [26]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt;  [51]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt;  [76]  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; [101]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; [126]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; [151]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; [176]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; [201]  0  0  0  0  0  0  0  0  0  0  0 NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events4$n_days</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events4$n_events4</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events4$duration_events4</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events4$event_dates</span>
<span class="co">#&gt; [1] "2013-12-22 UTC"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events4$n_event4_date</span>
<span class="co">#&gt;   [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt;  [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt;  [75] 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [112] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [149] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [186] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events4$events4_begin</span>
<span class="co">#&gt;   [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt;  [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt;  [75] 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [112] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [149] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [186] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events4$n_days_begin</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events4$n_events4_begin</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events4$duration_events4_begin</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events4$event_dates_begin</span>
<span class="co">#&gt; [1] "2013-12-22 UTC"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $events4$n_event4_date_begin</span>
<span class="co">#&gt;   [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt;  [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt;  [75] 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [112] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [149] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span>
<span class="co">#&gt; [186] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span></pre></body></html></div>
<p>To further explore these results, we first look into the formation of ice crust using the type of event 3. If we want to know the total number of days when there was ice crust formation, the number of events, and the duration of these events, we can use the functions <code><a href="../reference/analyze_weather.html">n_days()</a></code>, <code><a href="../reference/analyze_weather.html">n_events()</a></code>, and <code><a href="../reference/analyze_weather.html">duration_event()</a></code>. These functions can be calculated for the whole winter or only for the first half of the winter, if the argument <code>first_half = TRUE</code>. This is interesting because the formation of ice crust under or above the snow is generally more critical for reindeer and reindeer herders in the beginning of the winter season.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># number of days of events 3</span>
<span class="fu"><a href="../reference/analyze_weather.html">n_days</a></span>(<span class="no">weather_condition</span>, <span class="kw">event</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="co">#&gt; [1] 2</span>
<span class="co"># but if we condider the whole winter, there is one event more</span>
<span class="fu"><a href="../reference/analyze_weather.html">n_days</a></span>(<span class="no">weather_condition</span>, <span class="kw">event</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">first_half</span> <span class="kw">=</span> <span class="no">F</span>)
<span class="co">#&gt; [1] 3</span>

<span class="co"># number of events of type 3</span>
<span class="fu"><a href="../reference/analyze_weather.html">n_events</a></span>(<span class="no">weather_condition</span>, <span class="kw">event</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="co">#&gt; [1] 2</span>
<span class="co"># duration of events</span>
<span class="fu"><a href="../reference/analyze_weather.html">duration_event</a></span>(<span class="no">weather_condition</span>, <span class="kw">event</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="co">#&gt; [1] 1 1</span></pre></body></html></div>
<p>Other information can be obtained from the output of the <code><a href="../reference/analyze_weather.html">analyze_weather()</a></code> functions. For example, we can have the date when each event starts.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">weather_condition</span>$<span class="no">events3</span>$<span class="no">event_dates</span>
<span class="co">#&gt; [1] "2013-12-16 UTC" "2013-12-24 UTC" "2014-03-14 UTC"</span></pre></body></html></div>
<p>We can also count the number of events 4, for instance. In this year, there was a single event, in December. We will plot it to see the day when the temperature drops from more than +1°C to less than -1°C in the following day, and when the precipitation is higher than 3mm, which are the conditions for event 4.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co"># we can also calculate the number of events 4</span>
<span class="fu"><a href="../reference/analyze_weather.html">n_events</a></span>(<span class="no">weather_condition</span>, <span class="kw">event</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">first_half</span> <span class="kw">=</span> <span class="no">T</span>)
<span class="co">#&gt; [1] 1</span>

<span class="co"># copy output object</span>
<span class="no">to_plot</span> <span class="kw">&lt;-</span> <span class="no">weather_condition</span>
<span class="co"># have a time series for the following day and</span>
<span class="co"># select only the month of december to ease visualization</span>
<span class="no">to_plot</span>$<span class="no">weather_indices</span> <span class="kw">&lt;-</span> <span class="no">to_plot</span>$<span class="no">weather_indices</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">temp_avg_next</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">temp_avg</span>[-<span class="fl">1</span>], <span class="fl">NA</span>)) <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw pkg">lubridate</span><span class="kw ns">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/month.html">month</a></span>(<span class="no">date</span>) <span class="kw">==</span> <span class="fl">12</span>)

<span class="no">when_event4</span> <span class="kw">&lt;-</span> <span class="no">weather_condition</span>$<span class="no">events4</span>$<span class="no">event_dates_begin</span>

<span class="co"># function plot_weather, explained below</span>
<span class="no">to_plot</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_weather.html">plot_weather</a></span>(<span class="kw">term</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"temp_avg"</span>, <span class="st">"prec"</span>, <span class="st">"temp_avg_next"</span>)) +
  <span class="fu">geom_hline</span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1</span>,<span class="fl">1</span>), <span class="kw">linetype</span> <span class="kw">=</span> <span class="fl">2</span>) +
  <span class="fu">geom_hline</span>(<span class="kw">yintercept</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">color</span> <span class="kw">=</span> <span class="st">"darkgreen"</span>) +
  <span class="fu">geom_vline</span>(<span class="kw">xintercept</span> <span class="kw">=</span> <span class="no">when_event4</span>, <span class="kw">linetype</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span>(-<span class="fl">10</span>, <span class="fl">5</span>)</pre></body></html></div>
<p><img src="witch_start_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;"></p>
<p>In the plot above, the horizontal lines represent the limits of +1 and +1°C for temperature and 3 mm for precipitation, and the verical line represents the date the date when the ice crust (event 4) was formed. This figure uses the function <code><a href="../reference/plot_weather.html">plot_weather()</a></code>, that we explain below.</p>
</div>
<div id="plotting-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-variables" class="anchor"></a>Plotting variables</h2>
<p>To plot variables, we use the function <code><a href="../reference/plot_weather.html">plot_weather()</a></code>. Below we plot some of the input and derived variables for this winter.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co"># Snow depth and precipitation</span>
<span class="fu"><a href="../reference/plot_weather.html">plot_weather</a></span>(<span class="no">weather_condition</span>, <span class="kw">term</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"snow_depth"</span>, <span class="st">"precip"</span>))</pre></body></html></div>
<p><img src="witch_start_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><html><body><pre class="r">
<span class="co"># Snow depth and cumulative precipitation</span>
<span class="fu"><a href="../reference/plot_weather.html">plot_weather</a></span>(<span class="no">weather_condition</span>, <span class="kw">term</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"snow_de"</span>, <span class="st">"cum"</span>))</pre></body></html></div>
<p><img src="witch_start_files/figure-html/unnamed-chunk-9-2.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><html><body><pre class="r">
<span class="co"># Snow depth and cumulative precipitation, showing when the events 3 happened</span>
<span class="fu"><a href="../reference/plot_weather.html">plot_weather</a></span>(<span class="no">weather_condition</span>, <span class="kw">term</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"snow_de"</span>, <span class="st">"cum"</span>), <span class="kw">add_events</span> <span class="kw">=</span> <span class="st">"events3"</span>)</pre></body></html></div>
<p><img src="witch_start_files/figure-html/unnamed-chunk-9-3.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><html><body><pre class="r">
<span class="co"># Snow depth, cumulative precipitation, and the ratio snow_depth/cumulative_precipitation</span>
<span class="fu"><a href="../reference/plot_weather.html">plot_weather</a></span>(<span class="no">weather_condition</span>, <span class="kw">term</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"snow_de"</span>, <span class="st">"cum"</span>, <span class="st">"snow_prec_ratio"</span>))</pre></body></html></div>
<p><img src="witch_start_files/figure-html/unnamed-chunk-9-4.png" width="576" style="display: block; margin: auto;"></p>
<p>In the last plot it is almost impossible to observe the ratio between the variables, because the scale is very small compared to the input variables. In this case, we can add a multiplication factor for each term. For instance, we can divide snow depth and precipitation for 100 to represent them in meters instead of milimiters, as we do below.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_weather.html">plot_weather</a></span>(<span class="no">weather_condition</span>, <span class="kw">term</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"snow_de"</span>, <span class="st">"cum"</span>, <span class="st">"snow_prec_ratio"</span>),
             <span class="kw">factor_mult</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.01</span>,<span class="fl">.01</span>,<span class="fl">1</span>), <span class="kw">add_events</span> <span class="kw">=</span> <span class="st">"events3"</span>)</pre></body></html></div>
<p><img src="witch_start_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="to-do" class="section level1">
<h1 class="hasAnchor">
<a href="#to-do" class="anchor"></a>To do</h1>
<ul>
<li>Add explanation of the variables calculated</li>
<li>Add example for the function find_date_permanent_snow</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Bernardo Niebuhr, Anna Skarin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
